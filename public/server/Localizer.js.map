{"version":3,"sources":["../../src/server/Localizer.es6"],"names":["pjson","require","scanner","uuid","http","fs","request","Localizer","id","v4","oldUUID","readFileSync","e","writeFileSync","rows","data","action","fp_id","ap_ids","device_id","type","console","time","url","json","method","body","error","res","timeEnd","send","scan","err","networks","map","net","ap_id","mac","value","rssi","log","l","start"],"mappings":";;;;;;AAAA,IAAMA,QAAQC,QAAQ,oBAAR,CAAd;AACA,IAAMC,UAAUD,QAAQ,mBAAR,CAAhB;AACA,IAAME,OAAOF,QAAQ,MAAR,CAAb;AACA,IAAMG,OAAOH,QAAQ,MAAR,CAAb;AACA,IAAMI,KAAKJ,QAAQ,IAAR,CAAX;AACA,IAAMK,UAAUL,QAAQ,SAAR,CAAhB;;IAEMM,S;AACF,yBAAa;AAAA;;AACT,aAAKC,EAAL,GAAUL,KAAKM,EAAL,EAAV;AACA,YAAI;AACA,gBAAIC,UAAUL,GAAGM,YAAH,CAAgB,OAAhB,EAAyB,MAAzB,CAAd;AACA,iBAAKH,EAAL,GAAUE,OAAV;AACH,SAHD,CAGC,OAAME,CAAN,EAAQ;AACLP,eAAGQ,aAAH,CAAiB,OAAjB,EAA0B,KAAKL,EAA/B;AACH;AACJ;;;;6BAEIM,I,EAAK;AAAA;;AAGN,gBAAMC,OAAO;AACTC,wBAAQ,QADC;AAETC,uBAAO,kCAFE;AAGTC,wBAAQJ,IAHC;AAITK,2BAAW,KAAKX,EAJP;AAKTY,sBAAM;AALG,aAAb;;AAQAC,oBAAQC,IAAR,CAAa,MAAb;AACAhB,oBAAQ;AACJiB,qBAAK,qCADD;AAEJC,sBAAM,IAFF;AAGJC,wBAAQ,MAHJ;AAIJC,sBAAMX;AAJF,aAAR,EAKG,UAACY,KAAD,EAAQC,GAAR,EAAaF,IAAb,EAAsB;AACrBL,wBAAQQ,OAAR,CAAgB,MAAhB;;AAEA,sBAAKC,IAAL,CAAUhB,IAAV;AACH,aATD;AAUH;;;gCAEM;AAAA;;AACHZ,oBAAQ6B,IAAR,CAAa,UAACC,GAAD,EAAMC,QAAN,EAAmB;AAC5B,oBAAID,GAAJ,EAAS;AACLX,4BAAQM,KAAR,CAAcK,GAAd;AACA;AACH;;AAED,oBAAMlB,OAAOmB,SAASC,GAAT,CAAa,UAACC,GAAD,EAAS;AAC/B,2BAAO,EAACC,OAAOD,IAAIE,GAAZ,EAAiBC,OAAOH,IAAII,IAA5B,EAAP;AACH,iBAFY,CAAb;;AAIAlB,wBAAQmB,GAAR,CAAY1B,IAAZ;AACA,uBAAKgB,IAAL,CAAUhB,IAAV;AACH,aAZD;AAaH;;;;;;AAGL,IAAM2B,IAAI,IAAIlC,SAAJ,EAAV;AACAkC,EAAEC,KAAF","file":"Localizer.js","sourcesContent":["const pjson = require('../../package.json');\nconst scanner = require('node-wifi-scanner');\nconst uuid = require('uuid');\nconst http = require('http');\nconst fs = require('fs');\nconst request = require('request');\n\nclass Localizer {\n    constructor(){\n        this.id = uuid.v4();\n        try {\n            let oldUUID = fs.readFileSync(\".uuid\", \"utf8\");\n            this.id = oldUUID;\n        }catch(e){\n            fs.writeFileSync(\".uuid\", this.id);\n        }\n    }\n\n    send(rows){\n\n\n        const data = {\n            action: \"action\",\n            fp_id: \"336c6582c283421c28479e8801e8edfa\",\n            ap_ids: rows,\n            device_id: this.id,\n            type: \"COMPUTER\"\n        };\n\n        console.time('time');\n        request({\n            url: 'http://localhost:8888/rest/localize',\n            json: true,\n            method: \"POST\",\n            body: data\n        }, (error, res, body) => {\n            console.timeEnd('time');\n\n            this.send(rows);\n        });\n    }\n\n    start(){\n        scanner.scan((err, networks) => {\n            if (err) {\n                console.error(err);\n                return;\n            }\n\n            const rows = networks.map((net) => {\n                return {ap_id: net.mac, value: net.rssi};\n            });\n\n            console.log(rows);\n            this.send(rows);\n        });\n    }\n}\n\nconst l = new Localizer();\nl.start();"]}